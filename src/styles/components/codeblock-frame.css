/* Code block framing with left accent and small icon (applied only to DH-UI blocks) */
/* Use theme variables so it works across light/dark and different Obsidian themes */
.markdown-rendered pre:has(
  > code.language-badges,
  > code.language-consumables,
  > code.language-ability,
  > code.language-traits,
  > code.language-vitals,
  > code.language-vital-trackers,
  > code.language-hp,
  > code.language-stress,
  > code.language-armor,
  > code.language-hope,
  > code.language-rest,
  > code.language-damage,
  > code.language-experiences,
  > code.language-features,
  > code.language-domainpicker,
  > code.language-equipmentpicker,
  > code.language-levelup,
  > code.language-spell,
  > code.language-action
) {
  position: relative;
  border: 1px solid var(--background-modifier-border);
  border-left: 3px solid var(--code-accent, var(--text-accent));
  border-radius: 8px;
  padding: 8px 10px; /* keep simple padding */
  margin: 8px 0;
  /* background + text use theme variables for good contrast in both modes */
  background-color: var(--background-primary);
  color: var(--code-normal, var(--text-normal));
}

/* Slightly separate the code background if the theme supports it */
.markdown-rendered pre:has(
  > code.language-badges,
  > code.language-consumables,
  > code.language-ability,
  > code.language-traits,
  > code.language-vitals,
  > code.language-vital-trackers,
  > code.language-hp,
  > code.language-stress,
  > code.language-armor,
  > code.language-hope,
  > code.language-rest,
  > code.language-damage,
  > code.language-experiences,
  > code.language-features,
  > code.language-domainpicker,
  > code.language-equipmentpicker,
  > code.language-levelup,
  > code.language-spell,
  > code.language-action
) code {
  display: block;
  background-color: transparent;
  color: var(--code-normal, var(--text-normal));
  font-family: var(--font-monospace);
  font-size: var(--code-size, 0.9em);
  line-height: 1.4;
  padding: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-break: break-word;
}

/* Icon chip in the top-left corner of the frame */
.markdown-rendered pre:has(
  > code.language-badges,
  > code.language-consumables,
  > code.language-ability,
  > code.language-traits,
  > code.language-vitals,
  > code.language-vital-trackers,
  > code.language-hp,
  > code.language-stress,
  > code.language-armor,
  > code.language-hope,
  > code.language-rest,
  > code.language-damage,
  > code.language-experiences,
  > code.language-features,
  > code.language-domainpicker,
  > code.language-equipmentpicker,
  > code.language-levelup,
  > code.language-spell,
  > code.language-action
)::before {
  content: var(--code-icon, "");
  position: absolute;
  left: 6px;
  top: 6px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 14px;
  min-width: 14px;
  padding: 0 4px;
  font-size: 9px;
  line-height: 1;
  font-weight: 700;
  color: var(--background-primary);
  background: var(--code-accent, var(--text-accent));
  border-radius: 999px;
}

/* Language-specific accents (Chromium supports :has in Electron) */
.markdown-rendered pre:has(> code.language-js)     { --code-accent: #f7df1e; --code-icon: "JS"; }
.markdown-rendered pre:has(> code.language-ts)     { --code-accent: #3178c6; --code-icon: "TS"; }
.markdown-rendered pre:has(> code.language-json)   { --code-accent: #10b981; --code-icon: "JSON"; }
.markdown-rendered pre:has(> code.language-yaml),
.markdown-rendered pre:has(> code.language-yml)   { --code-accent: #f2c12e; --code-icon: "YAML"; }
.markdown-rendered pre:has(> code.language-html)   { --code-accent: #e34f26; --code-icon: "HTML"; }
.markdown-rendered pre:has(> code.language-css)    { --code-accent: #563d7c; --code-icon: "CSS"; }
.markdown-rendered pre:has(> code.language-md),
.markdown-rendered pre:has(> code.language-markdown) { --code-accent: #8e8e8e; --code-icon: "MD"; }
.markdown-rendered pre:has(> code.language-bash),
.markdown-rendered pre:has(> code.language-sh),
.markdown-rendered pre:has(> code.language-shell) { --code-accent: #4caf50; --code-icon: "SH"; }
.markdown-rendered pre:has(> code.language-python),
.markdown-rendered pre:has(> code.language-py)    { --code-accent: #3776ab; --code-icon: "PY"; }
.markdown-rendered pre:has(> code.language-rust),
.markdown-rendered pre:has(> code.language-rs)    { --code-accent: #dea584; --code-icon: "RS"; }
.markdown-rendered pre:has(> code.language-cpp),
.markdown-rendered pre:has(> code.language-c\+\+)   { --code-accent: #00599c; --code-icon: "C++"; }
.markdown-rendered pre:has(> code.language-csharp),
.markdown-rendered pre:has(> code.language-cs)    { --code-accent: #239120; --code-icon: "C#"; }

/* Obsidian DH-UI custom blocks: set accent + icon by block type (using shared palette) */
.markdown-rendered pre:has(> code.language-badges)      { --code-accent: #7a7f87; --code-icon: "BDG"; }
.markdown-rendered pre:has(> code.language-consumables) { --code-accent: var(--dh-consumables); --code-icon: "CON"; }
.markdown-rendered pre:has(> code.language-ability)     { --code-accent: var(--dh-traits); --code-icon: "ABL"; }
.markdown-rendered pre:has(> code.language-traits)      { --code-accent: var(--dh-traits); --code-icon: "TRT"; }
.markdown-rendered pre:has(> code.language-damage)      { --code-accent: #d32f2f; --code-icon: "\01F4A5"; }

/* For the live damage block, we don't want the outer pre frame; let the card handle styling */
.markdown-rendered pre:has(> code.language-damage) {
  border: none;
  border-radius: 0;
  padding: 0;
  margin: 6px 0;
  background: transparent;
}

.markdown-rendered pre:has(> code.language-damage)::before {
  content: none;
}

.markdown-rendered pre:has(> code.language-damage) code {
  padding: 0;
  background: transparent;
}

/* For vitals/vital-trackers, also strip the outer pre frame so only the rendered card shows */
.markdown-rendered pre:has(> code.language-vitals),
.markdown-rendered pre:has(> code.language-vital-trackers) {
  border: none;
  border-radius: 0;
  padding: 0;
  margin: 6px 0;
  background: transparent;
}

.markdown-rendered pre:has(> code.language-vitals)::before,
.markdown-rendered pre:has(> code.language-vital-trackers)::before {
  content: none;
}

.markdown-rendered pre:has(> code.language-vitals) code,
.markdown-rendered pre:has(> code.language-vital-trackers) code {
  padding: 0;
  background: transparent;
}

/* Rest blocks: we let the inner controls row handle its own styling, no pre-frame. */
.markdown-rendered pre:has(> code.language-rest) {
  border: none;
  border-radius: 0;
  padding: 0;
  margin: 6px 0;
  background: transparent;
}

.markdown-rendered pre:has(> code.language-rest)::before {
  content: none;
}

.markdown-rendered pre:has(> code.language-rest) code {
  padding: 0;
  background: transparent;
}
.markdown-rendered pre:has(> code.language-hp)          { --code-accent: var(--dh-red, #d85a56);   --code-icon: "HP"; }
.markdown-rendered pre:has(> code.language-stress)      { --code-accent: var(--dh-blue, #4f79e6);  --code-icon: "STR"; }
.markdown-rendered pre:has(> code.language-armor)       { --code-accent: var(--dh-gray, #9aa0a6);  --code-icon: "ARM"; }
.markdown-rendered pre:has(> code.language-hope)        { --code-accent: var(--dh-gold, #e6c14f);  --code-icon: "HOP"; }

